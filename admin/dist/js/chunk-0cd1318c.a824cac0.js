(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0cd1318c"],{"08f4":function(t,e,a){"use strict";a("f355")},"502e":function(t,e,a){"use strict";var n=a("2b0e");e["a"]=n["default"].mixin({data:function(){return{API_URL:"https://us-central1-lestido-renting.cloudfunctions.net/api"}},methods:{parseGQLErrors:function(t){var e;return t.graphQLErrors&&(e=t.graphQLErrors[0]?t.graphQLErrors[0].message:null),t.networkError&&!e&&(e=t.networkError.result.errors[0]?t.networkError.result.errors[0].message:null),t.message&&!e&&(e=t.message),e||(e="Ha ocurrido un error"),this.$toast.error(e),e}}})},"967a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{attrs:{loading:t.loading||t.saving,pageTitle:t.title},scopedSlots:t._u([{key:"cta",fn:function(){return["update"==t.action&&t.form?a("b-dropdown",{staticClass:"dropdown-dots",attrs:{"no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[a("i",{staticClass:"icon icon-dot-3"})]},proxy:!0}],null,!1,328388857)},[a("b-dropdown-item",{staticClass:"delete-item",on:{click:function(e){return t.deletePrompt(t.form)}}},[a("i",{staticClass:"icon icon-trashcan"}),t._v(" Eliminar")])],1):t._e()]},proxy:!0}])},[a("FormulateForm",{ref:"formCategory",staticStyle:{"max-width":"100%"},attrs:{name:"form"},on:{submit:t.save},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[t.loading?t._e():a("div",{staticClass:"main-container container"},[a("div",{staticClass:"row row-xs mt-4"},[a("div",{staticClass:"col-12 col-md-4"},[a("div",{staticClass:"card "},[a("div",{staticClass:"card-body"},[a("FormulateInput",{attrs:{label:"Imagen Listado",name:"image",type:"file",accept:"images",listStyle:"thumb",displayBlock:!0,"validation-name":"Imagen",validation:"required",help:"La imagen debe ser de 591px x 422px con fondo transparente"}}),a("FormulateInput",{attrs:{label:"Nombre",name:"name","validation-name":"Nombre",validation:"required"}}),a("FormulateInput",{attrs:{label:"Intro",name:"intro","validation-name":"Intro",validation:"required",type:"textarea"}}),a("FormulateInput",{attrs:{label:"Estado",name:"status",type:"select",options:{ACTIVE:"Activo",INACTIVE:"Inactivo"}}})],1)])]),a("div",{staticClass:"col-12 col-md-8"},[a("div",{staticClass:"card "},[a("div",{staticClass:"card-body"},[a("b-tabs",{attrs:{"content-class":"mt-3"}},[a("b-tab",{attrs:{title:"Propiedades"}},[a("div",{staticClass:"row row-xs"},[a("div",{staticClass:"col-12 "},[a("FormulateInput",{attrs:{label:"Imagen principal",name:"imageMain",type:"file",accept:"images",listStyle:"thumb",displayBlock:!0,"validation-name":"Imagen",validation:"required",help:"La imagen debe ser de 1400px x 640px"}})],1),a("div",{staticClass:"col-12 mt-3"},[a("FormulateInput",{attrs:{label:"Titulo de descripción",name:"detailTitle","validation-name":"Título",validation:"required"}})],1),a("div",{staticClass:"col-12 mt-3"},[a("FormulateInput",{attrs:{type:"wysiwyg",name:"detail",height:"200px",label:"Descripción",showMenuBar:!1}})],1),a("div",{staticClass:"col-12 mt-3"},[a("FormulateInput",{attrs:{label:"Ficha técnica",name:"dataSheet",type:"file",accept:"file",displayBlock:!0,help:"Ficha técnica PDF"}})],1)])]),a("b-tab",{attrs:{title:"Oferta"}},[a("div",{staticClass:"row row-xs"},[a("FormulateInput",{staticClass:"mt-3",attrs:{name:"featured",type:"checkbox",label:"Oportunidad?",help:"Las categorías marcadas como oportunidad serán mostradas en el home de la web."}}),a("FormulateInput",{staticClass:"mr-2",attrs:{label:"Precio desde",type:"price",name:"price","validation-name":"Precio",validation:t.form.featured?"required":null}}),a("FormulateInput",{attrs:{type:"wysiwyg",name:"featuredDetail",height:"200px",label:"Información de oferta",showMenuBar:!1}})],1)]),a("b-tab",{attrs:{title:"Galería"}},[a("FormulateInput",{attrs:{label:"Imagen",name:"gallery",type:"file",accept:"images",listStyle:"thumb",multiple:!0,"validation-name":"Imagen"}})],1)],1),a("hr"),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("FormulateInput",{attrs:{type:"button","data-ghost":""},on:{click:function(e){return t.$router.go(-1)}}},[t._v("Cancelar")]),t.saving?a("FormulateInput",{attrs:{type:"button",disabled:""}},[t._v("Guardando "),a("span",{staticClass:"loader"})]):a("FormulateInput",{attrs:{type:"submit",label:t.title}})],1)],1)])])])])])],1)},r=[],i=a("8785"),o=a("1da1"),s=(a("b0c0"),a("d81d"),a("96cf"),a("9530")),l=a.n(s),u=a("502e"),c=a("a0c5"),m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",t._l(t.images,(function(e,n){return a("div",{key:n,staticClass:"row item",on:{click:function(e){return t.open(n)}}},[a("div",{staticClass:"col-3"},[e.image?a("img",{staticClass:"img-fluid",attrs:{src:e.image.url}}):t._e()]),a("div",{staticClass:"col-9"},[a("h5",[t._v(t._s(e.title))]),a("div",{domProps:{innerHTML:t._s(e.body)}})])])})),0),a("div",[a("div",{staticClass:"btn btn-primary",on:{click:t.open}},[t._v("Agregar imagen")])]),a("b-modal",{attrs:{id:"imageForm",title:"Cargar imagen","no-close-on-backdrop":"","hide-footer":""}},[a("FormulateForm",{ref:"form",on:{submit:t.save},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[a("FormulateInput",{attrs:{label:"Imagen",name:"image",type:"file",accept:"images",listStyle:"thumb",displayBlock:!0,"validation-name":"Imagen"}}),a("FormulateInput",{attrs:{label:"Título",name:"title",type:"text","validation-name":"Título",validation:"required"}}),a("FormulateInput",{attrs:{type:"wysiwyg",name:"body",height:"200px",label:"Texto",showMenuBar:!1}}),a("hr"),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("FormulateInput",{attrs:{type:"button","data-ghost":""},on:{click:function(e){return t.close()}}},[t._v("Cancelar")]),a("FormulateInput",{attrs:{type:"submit",label:"Guardar"}})],1)],1)],1)],1)},d=[];a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function p(t){return p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}var g,f,b,h,y=a("5530"),v={name:"CategoryImages",mixins:[c["a"]],props:{images:{type:Array,default:[]}},data:function(){return{form:{index:null,title:null,body:null,image:null},action:"create",loading:!1}},beforeMount:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loading=!0,t.loading=!1;case 2:case"end":return e.stop()}}),e)})))()},methods:{open:function(t){t>=0&&(this.form=Object(y["a"])({index:t},this.images[t])),this.$bvModal.show("imageForm")},close:function(){this.$bvModal.hide("imageForm")},save:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.loading=!0,console.log(t.form),a={image:t.form.image?t.form.image.id:null,title:t.form.title,body:t.form.body},"create"==t.action&&t.create(a),"update"==t.action&&t.update(a),t.loading=!1,t.close();case 7:case"end":return e.stop()}}),e)})))()},create:function(t){console.log(p(this.images)),this.images=[],p(this.images),this.images.push(t),this.$emit("created",this.images)},update:function(t){this.$emit("updated",this.images)},deletePrompt:function(t){var e=this;this.$dialog.confirm({title:"Eliminar imagen",body:'¿Está seguro que desea eliminar la imagen "<strong>'.concat(form.title,'"</strong>?')},{okText:"Eliminar",customClass:"delete-prompt"}).then((function(){e.$emit("deleted",e.images)}))}}},C=v,w=(a("08f4"),a("2877")),I=Object(w["a"])(C,m,d,!1,null,"7224c477",null),x=I.exports,F={name:"CarCategoryForm",components:{CategoryImages:x},mixins:[u["a"],c["a"]],data:function(){return{title:"Crear categoría",action:"create",btnAction:"Crear categoría",form:{image:null,imageMain:null,images:[],gallery:[],dataSheet:null,slug:null,name:null,detailTitle:null,detail:null,featuredDetail:null,propAirConditioner:1,propPassengers:1,propDoors:1,propLuggages:1,propHandLuggages:1,propTransmission:null,propFuel:null},categoryTypes:[],offices:[],concepts:[],loading:!0,saving:!1}},beforeMount:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loading=!0,!t.$route.params.id){e.next=7;break}return t.action="update",t.title="Editar categoría",t.btnAction="Guardar cambios",e.next=7,t.load();case 7:t.loading=!1;case 8:case"end":return e.stop()}}),e)})))()},methods:{imageCreated:function(t){console.log("image created",t),this.form.images=t},imageUpdated:function(t){console.log("image updated",t)},imageDeleted:function(t){console.log("image deleted",t)},save:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.saving=!0,a={image:t.form.image?t.form.image.id:null,imageMain:t.form.imageMain?t.form.imageMain.id:null,dataSheet:t.form.dataSheet?t.form.dataSheet.id:null,name:t.form.name,detailTitle:t.form.detailTitle,intro:t.form.intro,detail:t.form.detail,price:t.form.price?parseFloat(t.form.price):0,propFuel:t.form.propFuel,propTransmission:t.form.propTransmission,propPassengers:parseInt(t.form.propPassengers),propDoors:parseInt(t.form.propDoors),propLuggages:parseInt(t.form.propLuggages),propHandLuggages:parseInt(t.form.propHandLuggages),propAirConditioner:!!t.form.propAirConditioner,featured:!!t.form.featured,featuredDetail:t.form.featuredDetail,status:t.form.status,images:t.form.images?t.form.images.map((function(t){return{title:t.title,body:t.body,image:t.image?t.image.id:null}})):[],gallery:t.form.gallery.length>0?t.form.gallery.map((function(t){return t?t.id:null})):[]},"create"!=t.action){e.next=5;break}return e.next=5,t.create(a);case 5:if("update"!=t.action){e.next=8;break}return e.next=8,t.update(a);case 8:t.saving=!1;case 9:case"end":return e.stop()}}),e)})))()},create:function(t){var e=this;return this.$apollo.mutate({mutation:l()(g||(g=Object(i["a"])(["\n\t\t\t\t\t\tmutation($data: CarCategoryInput!) {\n\t\t\t\t\t\t\tcarCategoryCreate(data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{data:t}}).then((function(){e.$toast.success("Categoría creada correctamente"),e.loading=!1,e.saving=!1,e.$router.go(-1)})).catch((function(t){e.parseGQLErrors(t),e.loading=!1}))},update:function(t){var e=this;return this.$apollo.mutate({mutation:l()(f||(f=Object(i["a"])(["\n\t\t\t\t\t\tmutation($id: ID!, $data: CarCategoryInput!) {\n\t\t\t\t\t\t\tcarCategoryUpdate(id: $id, data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id,data:t}}).then((function(){e.$toast.success("Categoría editada correctamente"),e.saving=!1,e.$router.go(-1)})).catch((function(t){e.errors=e.parseGQLErrors(t)}))},load:function(){var t=this;return this.$apollo.query({query:l()(b||(b=Object(i["a"])(["\n\t\t\t\t\t\tquery($id: ID!) {\n\t\t\t\t\t\t\tcarCategory(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\tslug\n\t\t\t\t\t\t\t\timage {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdataSheet {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\timageMain {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tgallery {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\timages {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\t\t\tbody\n\t\t\t\t\t\t\t\t\timage {\n\t\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tdetailTitle\n\t\t\t\t\t\t\t\tintro\n\t\t\t\t\t\t\t\tdetail\n\t\t\t\t\t\t\t\tfeatured\n\t\t\t\t\t\t\t\tfeaturedDetail\n\t\t\t\t\t\t\t\tprice\n\t\t\t\t\t\t\t\tpropAirConditioner\n\t\t\t\t\t\t\t\tpropPassengers\n\t\t\t\t\t\t\t\tpropDoors\n\t\t\t\t\t\t\t\tpropLuggages\n\t\t\t\t\t\t\t\tpropHandLuggages\n\t\t\t\t\t\t\t\tpropTransmission\n\t\t\t\t\t\t\t\tpropFuel\n\t\t\t\t\t\t\t\tstatus\n\t\t\t\t\t\t\t\tstatusText\n\t\t\t\t\t\t\t\tstatusClass\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id},fetchPolicy:"network-only"}).then((function(e){var a=e.data;t.form=a.carCategory})).catch((function(){t.$toast.success("El item que desea editar no existe"),t.$router.go(-1)}))},deletePrompt:function(t){var e=this;this.$dialog.confirm({title:"Eliminar categoría",body:'¿Está seguro que desea eliminar la categoría "<strong>'.concat(t.name,'"</strong>?')},{okText:"Eliminar",customClass:"delete-prompt"}).then((function(){e.delete(t)}))},delete:function(t){var e=this;t.loading=!0,this.$apollo.mutate({mutation:l()(h||(h=Object(i["a"])(["\n\t\t\t\t\t\tmutation($id: ID!) {\n\t\t\t\t\t\t\tcarCategoryDelete(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:t.id}}).then((function(){e.$toast.success("Categoría eliminada correctamente"),e.load()})).catch((function(a){e.errors=e.parseGQLErrors(a),t.loading=!1}))}}},$=F,k=Object(w["a"])($,n,r,!1,null,null,null);e["default"]=k.exports},a0c5:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var n=a("06c5");function r(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(n["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(l)throw o}}}}a("b0c0");var i=a("2b0e");e["a"]=i["default"].mixin({data:function(){return{saving:!1}},methods:{covertArrayToSelectableObject:function(t){var e,a=[],n=r(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;a.push({value:i.id,label:i.name})}}catch(o){n.e(o)}finally{n.f()}return a}}})},f355:function(t,e,a){}}]);
//# sourceMappingURL=chunk-0cd1318c.a824cac0.js.map