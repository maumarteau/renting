(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["ProductForm"],{"502e":function(t,e,a){"use strict";var r=a("2b0e");e["a"]=r["default"].mixin({data:function(){return{API_URL:"https://us-central1-lestido-renting.cloudfunctions.net/api"}},methods:{parseGQLErrors:function(t){var e;return t.graphQLErrors&&(e=t.graphQLErrors[0]?t.graphQLErrors[0].message:null),t.networkError&&!e&&(e=t.networkError.result.errors[0]?t.networkError.result.errors[0].message:null),t.message&&!e&&(e=t.message),e||(e="Ha ocurrido un error"),this.$toast.error(e),e}}})},a0c5:function(t,e,a){"use strict";a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");var r=a("06c5");function n(t,e){var a="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=Object(r["a"])(t))||e&&t&&"number"===typeof t.length){a&&(t=a);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,s=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return l=t.done,t},e:function(t){s=!0,i=t},f:function(){try{l||null==a["return"]||a["return"]()}finally{if(s)throw i}}}}a("b0c0");var o=a("2b0e");e["a"]=o["default"].mixin({data:function(){return{saving:!1}},methods:{covertArrayToSelectableObject:function(t){var e,a=[],r=n(t);try{for(r.s();!(e=r.n()).done;){var o=e.value;a.push({value:o.id,label:o.name})}}catch(i){r.e(i)}finally{r.f()}return a}}})},d479:function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-link",{staticClass:"breadcrumb-item",attrs:{tag:"li",to:"/"}},[a("i",{staticClass:"icon icon-home-1"})]),a("router-link",{staticClass:"breadcrumb-item",attrs:{tag:"li",to:"/products"}},[t._v(" Vehículos usados ")]),"ProductCreate"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Crear ")]):t._e(),"ProductEdit"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Editar ")]):t._e(),"ProductDetail"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Detalle ")]):t._e()],1)},n=[],o={name:"ProductBreadcrumb"},i=o,l=a("2877"),s=Object(l["a"])(i,r,n,!1,null,null,null);e["a"]=s.exports},f990:function(t,e,a){"use strict";a.r(e);var r,n,o,i,l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{attrs:{loading:t.loading||t.saving,pageTitle:t.title},scopedSlots:t._u([{key:"cta",fn:function(){return["update"==t.action&&t.form?a("b-dropdown",{staticClass:"dropdown-dots",attrs:{"no-caret":"",right:""},scopedSlots:t._u([{key:"button-content",fn:function(){return[a("i",{staticClass:"icon icon-dot-3"})]},proxy:!0}],null,!1,328388857)},[a("b-dropdown-item",{staticClass:"delete-item",on:{click:function(e){return t.deletePrompt(t.form)}}},[a("i",{staticClass:"icon icon-trashcan"}),t._v(" Eliminar")])],1):t._e()]},proxy:!0}])},[a("FormulateForm",{ref:"formProduct",staticStyle:{"max-width":"100%"},attrs:{name:"form"},on:{submit:t.save},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[t.loading?t._e():a("div",{staticClass:"main-container container"},[a("div",{staticClass:"row row-xs mt-4"},[a("div",{staticClass:"col-12 col-md-4"},[a("div",{staticClass:"card "},[a("div",{staticClass:"card-body"},[a("FormulateInput",{attrs:{label:"Título",name:"title","validation-name":"Título",validation:"required"}}),a("FormulateInput",{attrs:{label:"Estado",name:"status",type:"select",options:{ACTIVE:"Activo",INACTIVE:"Inactivo",SOLD:"Vendido"}}})],1)])]),a("div",{staticClass:"col-12 col-md-8"},[a("div",{staticClass:"card "},[a("div",{staticClass:"card-body"},[a("b-tabs",{attrs:{"content-class":"mt-3"}},[a("b-tab",{attrs:{title:"Información General"}},[a("div",{staticClass:"row row-xs"},[a("div",{staticClass:"col-12"},[a("FormulateInput",{attrs:{type:"wysiwyg",name:"description",height:"200px",label:"Descripción","validation-name":"Descripción",validation:"required",showMenuBar:!1}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Precio (USD)",type:"number",name:"price","validation-name":"Precio",validation:"required|min:1",step:"0.01",min:"0"}})],1)])]),a("b-tab",{attrs:{title:"Datos del Vehículo"}},[a("div",{staticClass:"row row-xs"},[a("div",{staticClass:"col-12 col-md-6"},[a("FormulateInput",{attrs:{label:"Marca",name:"brand",placeholder:"Ej: Toyota, Volkswagen, Ford..."}})],1),a("div",{staticClass:"col-12 col-md-6"},[a("FormulateInput",{attrs:{label:"Modelo",name:"model",placeholder:"Ej: Corolla, Golf, Focus..."}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Año",type:"number",name:"year",min:1990,max:(new Date).getFullYear()+1}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Kilometraje",name:"mileage",placeholder:"Ej: 50,000 km"}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Combustible",name:"fuel",type:"select",options:{gasoline:"Nafta",diesel:"Gasoil",hybrid:"Híbrido",electric:"Eléctrico"}}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Transmisión",name:"transmission",type:"select",options:{manual:"Manual",automatic:"Automática"}}})],1),a("div",{staticClass:"col-12 col-md-6 mt-3"},[a("FormulateInput",{attrs:{label:"Color",name:"color",placeholder:"Ej: Blanco, Negro, Azul..."}})],1)])]),a("b-tab",{attrs:{title:"Galería"}},[a("FormulateInput",{attrs:{label:"Fotos del vehículo",name:"files",type:"file",accept:"images",listStyle:"thumb",multiple:!0,"validation-name":"Fotos",help:"Sube múltiples fotos del vehículo. Se recomienda al menos 3-5 fotos. (Opcional)"}})],1)],1),a("hr"),a("div",{staticClass:"d-flex justify-content-between mt-4"},[a("FormulateInput",{attrs:{type:"button","data-ghost":""},on:{click:function(e){return t.$router.go(-1)}}},[t._v("Cancelar")]),t.saving?a("FormulateInput",{attrs:{type:"button",disabled:""}},[t._v("Guardando "),a("span",{staticClass:"loader"})]):a("FormulateInput",{attrs:{type:"submit",label:t.title}})],1)],1)])])])])])],1)},s=[],c=a("8785"),u=a("1da1"),d=(a("a4d3"),a("e01a"),a("d81d"),a("96cf"),a("9530")),m=a.n(d),p=a("502e"),f=a("a0c5"),b=a("d479"),v={name:"ProductForm",components:{Breadcrumb:b["a"]},mixins:[p["a"],f["a"]],data:function(){return{title:"Crear vehículo",action:"create",btnAction:"Crear vehículo",form:{title:null,description:null,price:null,files:[],brand:null,model:null,year:null,mileage:null,fuel:null,transmission:null,color:null,status:"ACTIVE"},loading:!0,saving:!1}},beforeMount:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.loading=!0,!t.$route.params.id){e.next=7;break}return t.action="update",t.title="Editar vehículo",t.btnAction="Guardar cambios",e.next=7,t.load();case 7:t.loading=!1;case 8:case"end":return e.stop()}}),e)})))()},methods:{save:function(){var t=this;return Object(u["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.saving=!0,a={title:t.form.title,description:t.form.description,price:t.form.price?parseFloat(t.form.price):0,files:t.form.files.length>0?t.form.files.map((function(t){return t?t.id:null})):[],brand:t.form.brand,model:t.form.model,year:t.form.year?parseInt(t.form.year):null,mileage:t.form.mileage,fuel:t.form.fuel,transmission:t.form.transmission,color:t.form.color,status:t.form.status},"create"!=t.action){e.next=5;break}return e.next=5,t.create(a);case 5:if("update"!=t.action){e.next=8;break}return e.next=8,t.update(a);case 8:t.saving=!1;case 9:case"end":return e.stop()}}),e)})))()},create:function(t){var e=this;return this.$apollo.mutate({mutation:m()(r||(r=Object(c["a"])(["\n\t\t\t\t\t\tmutation($data: ProductInput!) {\n\t\t\t\t\t\t\tproductCreate(data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{data:t}}).then((function(){e.$toast.success("Vehículo creado correctamente"),e.loading=!1,e.saving=!1,e.$router.go(-1)})).catch((function(t){e.parseGQLErrors(t),e.loading=!1}))},update:function(t){var e=this;return this.$apollo.mutate({mutation:m()(n||(n=Object(c["a"])(["\n\t\t\t\t\t\tmutation($id: ID!, $data: ProductInput!) {\n\t\t\t\t\t\t\tproductUpdate(id: $id, data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id,data:t}}).then((function(){e.$toast.success("Vehículo editado correctamente"),e.saving=!1,e.$router.go(-1)})).catch((function(t){e.errors=e.parseGQLErrors(t)}))},load:function(){var t=this;return this.$apollo.query({query:m()(o||(o=Object(c["a"])(["\n\t\t\t\t\t\tquery($id: ID!) {\n\t\t\t\t\t\t\tproduct(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\t\tslug\n\t\t\t\t\t\t\t\tdescription\n\t\t\t\t\t\t\t\tprice\n\t\t\t\t\t\t\t\tfiles {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbrand\n\t\t\t\t\t\t\t\tmodel\n\t\t\t\t\t\t\t\tyear\n\t\t\t\t\t\t\t\tmileage\n\t\t\t\t\t\t\t\tfuel\n\t\t\t\t\t\t\t\ttransmission\n\t\t\t\t\t\t\t\tcolor\n\t\t\t\t\t\t\t\tstatus\n\t\t\t\t\t\t\t\tstatusText\n\t\t\t\t\t\t\t\tstatusClass\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id},fetchPolicy:"network-only"}).then((function(e){var a=e.data;t.form=a.product})).catch((function(){t.$toast.error("El vehículo que desea editar no existe"),t.$router.go(-1)}))},deletePrompt:function(t){var e=this;this.$dialog.confirm({title:"Eliminar vehículo",body:'¿Está seguro que desea eliminar el vehículo "<strong>'.concat(t.title,'</strong>"?')},{okText:"Eliminar",customClass:"delete-prompt"}).then((function(){e.delete(t)}))},delete:function(t){var e=this;this.$apollo.mutate({mutation:m()(i||(i=Object(c["a"])(["\n\t\t\t\t\t\tmutation($id: ID!) {\n\t\t\t\t\t\t\tproductDelete(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:t.id}}).then((function(){e.$toast.success("Vehículo eliminado correctamente"),e.$router.go(-1)})).catch((function(t){e.errors=e.parseGQLErrors(t)}))}}},h=v,g=a("2877"),y=Object(g["a"])(h,l,s,!1,null,null,null);e["default"]=y.exports}}]);