(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-700cc8b4"],{"1ee0":function(t,e,a){"use strict";a("65c6")},2562:function(t,e,a){"use strict";a.r(e);var n,r,i,o,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{attrs:{loading:t.loading,pageTitle:t.title},scopedSlots:t._u([{key:"cta",fn:function(){},proxy:!0}])},[a("div",{staticClass:"main-container container"},[a("div",{staticClass:"card mt-2"},[a("div",{staticClass:"card-body"},[a("FormulateForm",{ref:"form",on:{submit:t.save},model:{value:t.form,callback:function(e){t.form=e},expression:"form"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12 col-md-3 "},[a("FormulateInput",{attrs:{label:"Imagen",name:"image",type:"file",listStyle:"thumb",accept:"images","validation-name":"Imagen de portada",help:"La imagen debe ser de 752px x 348px"}})],1),a("div",{staticClass:"col-12 col-md-9 "},[a("FormulateInput",{attrs:{label:"Titulo del artículo",name:"title","validation-name":"Título",validation:"required"}}),a("FormulateInput",{attrs:{type:"slug",name:"slug",label:"Slug",placeholder:"Slug",help:"Url a la página",validation:"required|checkSlug","validation-rules":{checkSlug:t.checkSlug},"validation-messages":{checkSlug:"Ya existe el slug ingresado"}}}),a("FormulateInput",{attrs:{name:"featured",type:"checkbox",label:"Página destacada",help:"Las páginas destacadas serán mostradas en el home de la web"}})],1)]),a("div",{staticClass:"mt-3"},[a("FormulateInput",{attrs:{type:"wysiwyg",name:"intro",height:"200px",label:"Introducción",showMenuBar:!1}})],1),a("div",{staticClass:"mt-3"},[a("FormulateInput",{attrs:{type:"checkbox",label:"Redireccionar a otra sección?",help:"Si redirecciona a otra sección debe ingresar el link, de lo contrario, ingrese el contenido a mostrar"},model:{value:t.fullSection,callback:function(e){t.fullSection=e},expression:"fullSection"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:t.fullSection,expression:"fullSection"}],staticClass:"mt-3"},[a("FormulateInput",{attrs:{label:"Link"},model:{value:t.form.link,callback:function(e){t.$set(t.form,"link",e)},expression:"form.link"}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.fullSection,expression:"!fullSection"}],staticClass:"mt-3"},[a("FormulateInput",{attrs:{type:"wysiwyg",name:"body",label:"Contenido",showMenuBar:!0}})],1),a("div",{staticClass:"d-flex justify-content-between mt-3"},[a("div",{staticClass:"btn btn-outline-secondary",on:{click:function(e){return t.$router.go(-1)}}},[t._v(" Cancelar ")]),a("FormulateInput",{attrs:{type:"submit",label:t.title}})],1)])],1)])])])},l=[],u=a("1da1"),c=a("8785"),d=(a("96cf"),a("9911"),a("9530")),m=a.n(d),f=a("502e"),p={name:"PageForm",mixins:[f["a"]],data:function(){return{title:"Crear sección",action:"create",fullSection:!1,form:{image:null,slug:"",title:"",featured:!1,body:""},loading:!1}},beforeMount:function(){this.$route.params.id&&(this.action="update",this.load())},methods:{save:function(){this.loading=!0;var t={image:this.form.image?this.form.image.id:null,slug:this.form.slug,title:this.form.title,body:this.fullSection?"":this.form.body,intro:this.form.intro,featured:this.form.featured,link:this.fullSection?this.form.link:null};"create"==this.action&&this.create(t),"update"==this.action&&this.update(t)},create:function(t){var e=this;this.$apollo.mutate({mutation:m()(n||(n=Object(c["a"])(["\n\t\t\t\t\t\tmutation($data: PageInput!) {\n\t\t\t\t\t\t\tpageCreate(data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{data:t}}).then((function(){e.$toast.success("Sección creada correctamente"),e.loading=!1,e.$router.go(-1)})).catch((function(t){e.parseGQLErrors(t),e.loading=!1}))},update:function(t){var e=this;this.$apollo.mutate({mutation:m()(r||(r=Object(c["a"])(["\n\t\t\t\t\t\tmutation($id: ID!, $data: PageInput!) {\n\t\t\t\t\t\t\tpageUpdate(id: $id, data: $data) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id,data:t}}).then((function(){e.$toast.success("Sección editada correctamente"),e.loading=!1,e.$router.go(-1)})).catch((function(t){e.errors=e.parseGQLErrors(t),e.saving=!1}))},load:function(){var t=this;this.$apollo.query({query:m()(i||(i=Object(c["a"])(["\n\t\t\t\t\t\tquery($id: ID!) {\n\t\t\t\t\t\t\tpage(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\tslug\n\t\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\t\tintro\n\t\t\t\t\t\t\t\tbody\n\t\t\t\t\t\t\t\tlink\n\t\t\t\t\t\t\t\tfeatured\n\t\t\t\t\t\t\t\timage {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\tfilename\n\t\t\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:this.$route.params.id},fetchPolicy:"network-only"}).then((function(e){t.form=e.data.page,t.title="Editar sección",t.loading=!1})).catch((function(){t.$toast.success("El item que desea editar no existe"),t.$router.go(-1)}))},checkSlug:function(t){var e=this;return Object(u["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=t.value,!n){a.next=8;break}return a.next=4,e.$apollo.query({query:m()(o||(o=Object(c["a"])(["\n\t\t\t\t\t\tquery($slug: String!) {\n\t\t\t\t\t\t\tpageCheckSlug(slug: $slug) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{slug:n},fetchPolicy:"network-only"});case 4:if(r=a.sent,null==r.data.pageCheckSlug||r.data.pageCheckSlug.id==e.$route.params.id){a.next=7;break}return a.abrupt("return",!1);case 7:return a.abrupt("return",!0);case 8:return a.abrupt("return",!0);case 9:case"end":return a.stop()}}),a)})))()}}},g=p,h=(a("1ee0"),a("2877")),v=Object(h["a"])(g,s,l,!1,null,"54c8120f",null);e["default"]=v.exports},"502e":function(t,e,a){"use strict";var n=a("2b0e");e["a"]=n["default"].mixin({data:function(){return{API_URL:"https://us-central1-lestido-renting.cloudfunctions.net/api"}},methods:{parseGQLErrors:function(t){var e;return t.graphQLErrors&&(e=t.graphQLErrors[0]?t.graphQLErrors[0].message:null),t.networkError&&!e&&(e=t.networkError.result.errors[0]?t.networkError.result.errors[0].message:null),t.message&&!e&&(e=t.message),e||(e="Ha ocurrido un error"),this.$toast.error(e),e}}})},"65c6":function(t,e,a){},"857a":function(t,e,a){var n=a("1d80"),r=/"/g;t.exports=function(t,e,a,i){var o=String(n(t)),s="<"+e;return""!==a&&(s+=" "+a+'="'+String(i).replace(r,"&quot;")+'"'),s+">"+o+"</"+e+">"}},9911:function(t,e,a){"use strict";var n=a("23e7"),r=a("857a"),i=a("af03");n({target:"String",proto:!0,forced:i("link")},{link:function(t){return r(this,"a","href",t)}})},af03:function(t,e,a){var n=a("d039");t.exports=function(t){return n((function(){var e=""[t]('"');return e!==e.toLowerCase()||e.split('"').length>3}))}}}]);
//# sourceMappingURL=chunk-700cc8b4.2b9f975a.js.map