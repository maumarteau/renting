(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Products"],{2266:function(t,e,a){var i=a("825a"),r=a("e95a"),n=a("50c4"),s=a("0366"),o=a("35a1"),l=a("9bdd"),c=function(t,e){this.stopped=t,this.result=e},u=t.exports=function(t,e,a,u,d){var f,m,h,p,v,g,b,_=s(e,a,u?2:1);if(d)f=t;else{if(m=o(t),"function"!=typeof m)throw TypeError("Target is not iterable");if(r(m)){for(h=0,p=n(t.length);p>h;h++)if(v=u?_(i(b=t[h])[0],b[1]):_(t[h]),v&&v instanceof c)return v;return new c(!1)}f=m.call(t)}g=f.next;while(!(b=g.call(f)).done)if(v=l(f,_,b.value,u),"object"==typeof v&&v&&v instanceof c)return v;return new c(!1)};u.stop=function(t){return new c(!0,t)}},"4fad":function(t,e,a){var i=a("23e7"),r=a("6f53").entries;i({target:"Object",stat:!0},{entries:function(t){return r(t)}})},"6f53":function(t,e,a){var i=a("83ab"),r=a("df75"),n=a("fc6a"),s=a("d1e7").f,o=function(t){return function(e){var a,o=n(e),l=r(o),c=l.length,u=0,d=[];while(c>u)a=l[u++],i&&!s.call(o,a)||d.push(t?[a,o[a]]:o[a]);return d}};t.exports={entries:o(!0),values:o(!1)}},"7b7a":function(t,e,a){"use strict";a("a7cb")},"9f12":function(t,e,a){"use strict";function i(t){if(Array.isArray(t))return t}a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0");function r(t,e){var a=t&&("undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=a){var i,r,n=[],s=!0,o=!1;try{for(a=a.call(t);!(s=(i=a.next()).done);s=!0)if(n.push(i.value),e&&n.length===e)break}catch(l){o=!0,r=l}finally{try{s||null==a["return"]||a["return"]()}finally{if(o)throw r}}return n}}var n=a("06c5");function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){return i(t)||r(t,e)||Object(n["a"])(t,e)||s()}a("159b"),a("b64b"),a("4de4"),a("ac1f"),a("5319"),a("c1f9"),a("4fad");var l=a("2b0e");e["a"]=l["default"].mixin({data:function(){return{pagination:{page:1,length:15,pageInfo:{totalItems:0}}}},methods:{getValidUrlParams:function(){var t=this.$route.query;t.page&&(this.pagination.page=t.page,this.pagination.skip=(t.page-1)*this.pagination.length,delete t.page),t.length&&(this.pagination.length=parseInt(t.length)),t.startDate&&(t.startDate=this.$moment(t.startDate).format("YYYY-MM-DD 00:00:00")),t.endDate&&(t.endDate=this.$moment(t.endDate).format("YYYY-MM-DD 23:59:59"));var e={};return Object.keys(t).forEach((function(a){var i=t[a];Array.isArray(i)&&(i=i.filter(Boolean)),""!=i&&null!=i&&i.length>0&&(e[a]=i)})),e},cleanFilters:function(){var t=this.filters,e={};return Object.keys(t).forEach((function(a){var i=t[a];""!=i&&(e[a]=i)})),e},pageChange:function(t){console.log(t);var e=this.getValidUrlParams();e.page=t+1,this.$router.replace({query:e})},pageLength:function(t){var e=this.getValidUrlParams();e.page=1,e.length=t,this.$router.replace({query:e})},selectedDateRangeFilter:function(t){t.startDate?this.filters.startDate=this.$moment(t.startDate).format("YYYY-MM-DD"):this.filters.startDate=null,t.endDate?this.filters.endDate=this.$moment(t.endDate).format("YYYY-MM-DD"):this.filters.endDate=null,this.updateFilters()},updateFilters:function(){var t=this.cleanFilters();t.startDate&&(t.startDate=this.$moment(t.startDate).format("YYYY-MM-DD")),t.endDate&&(t.endDate=this.$moment(t.endDate).format("YYYY-MM-DD")),t=Object.fromEntries(Object.entries(t).filter((function(t){var e=o(t,2),a=(e[0],e[1]);return null!=a}))),delete this.filters.page,this.$router.replace({query:t})}}})},a7cb:function(t,e,a){},c1f9:function(t,e,a){var i=a("23e7"),r=a("2266"),n=a("8418");i({target:"Object",stat:!0},{fromEntries:function(t){var e={};return r(t,(function(t,a){n(e,t,a)}),void 0,!0),e}})},d479:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("router-link",{staticClass:"breadcrumb-item",attrs:{tag:"li",to:"/"}},[a("i",{staticClass:"icon icon-home-1"})]),a("router-link",{staticClass:"breadcrumb-item",attrs:{tag:"li",to:"/products"}},[t._v(" Vehículos usados ")]),"ProductCreate"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Crear ")]):t._e(),"ProductEdit"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Editar ")]):t._e(),"ProductDetail"==t.$route.name?a("li",{staticClass:"breadcrumb-item active"},[t._v(" Detalle ")]):t._e()],1)},r=[],n={name:"ProductBreadcrumb"},s=n,o=a("2877"),l=Object(o["a"])(s,i,r,!1,null,null,null);e["a"]=l.exports},fadd:function(t,e,a){"use strict";a.r(e);var i,r,n,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("Layout",{attrs:{loading:t.loading,pageTitle:"Vehículos Usados"},scopedSlots:t._u([{key:"cta",fn:function(){return[a("router-link",{staticClass:"btn btn-success",attrs:{tag:"a",to:"/products/create"}},[t._v("Crear vehículo")])]},proxy:!0}])},[a("div",{staticClass:"main-container container-fluid"},[a("div",{staticClass:"card mt-2"},[a("div",{staticClass:"card-body"},[a("div",{staticClass:"row mb-3"},[a("div",{staticClass:"col-md-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.filters.search,expression:"filters.search"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Buscar por título, marca, modelo..."},domProps:{value:t.filters.search},on:{input:[function(e){e.target.composing||t.$set(t.filters,"search",e.target.value)},t.debounceSearch]}})]),a("div",{staticClass:"col-md-2"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.filters.status,expression:"filters.status"}],staticClass:"form-control",on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.$set(t.filters,"status",e.target.multiple?a:a[0])},t.load]}},[a("option",{attrs:{value:""}},[t._v("Todos los estados")]),a("option",{attrs:{value:"ACTIVE"}},[t._v("Activo")]),a("option",{attrs:{value:"INACTIVE"}},[t._v("Inactivo")]),a("option",{attrs:{value:"SOLD_AND_PUBLISHED"}},[t._v("Vendido y publicado")]),a("option",{attrs:{value:"SOLD"}},[t._v("Vendido oculto")])])]),a("div",{staticClass:"col-md-1"},[a("button",{staticClass:"btn btn-secondary",on:{click:t.clearFilters}},[t._v("Limpiar")])])]),a("draggable",{staticClass:"table table-clickeable",attrs:{tag:"table",handle:".handle","ghost-class":"ghost"},on:{change:t.sorted},model:{value:t.list,callback:function(e){t.list=e},expression:"list"}},[a("tr",{staticClass:"table-head",attrs:{slot:"header"},slot:"header"},[a("td",{attrs:{width:"36"}}),a("td",[t._v("Vehículo")]),a("td",[t._v("Marca/Modelo")]),a("td",[t._v("Precio")]),a("td",[t._v("Año")]),a("td",[t._v("Estado")]),a("td",[t._v("Acciones")])]),t._l(t.list,(function(e,i){return a("router-link",{key:i,attrs:{tag:"tr",to:t.$route.path+"/"+e.id}},[a("td",[a("div",{staticClass:"handle"},[a("i",{staticClass:"icon icon-arrow-combo text-secondary"})])]),a("td",[a("div",{staticClass:"d-flex align-items-center"},[e.image?a("img",{staticClass:"product-thumb mr-3",attrs:{src:e.image.urlThumb,alt:e.title}}):t._e(),a("div",[a("strong",[t._v(t._s(e.title))])])])]),a("td",[e.brand||e.model?a("div",[a("strong",[t._v(t._s(e.brand))]),a("div",{staticClass:"text-muted small"},[t._v(t._s(e.model))])]):a("span",{staticClass:"text-muted"},[t._v("-")])]),a("td",{staticClass:"text-right"},[e.price>0?a("div",[a("strong",[t._v("U$S "+t._s(e.price.toLocaleString()))])]):a("span",{staticClass:"text-muted"},[t._v("-")])]),a("td",[e.year?a("span",[t._v(t._s(e.year))]):a("span",{staticClass:"text-muted"},[t._v("-")])]),a("td",[a("span",{staticClass:"d-flex"},[a("i",{staticClass:"dot mt-1 mr-1",class:"dot-"+e.statusClass}),a("span",[t._v(t._s(e.statusText))])])]),a("td",{staticClass:"text-right"},[a("b-dropdown",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}},{name:"b-tooltip",rawName:"v-b-tooltip.left",modifiers:{left:!0}}],attrs:{"no-caret":"",right:"",title:"Mas acciones"},scopedSlots:t._u([e.loading?{key:"button-content",fn:function(){return[a("i",{staticClass:"icon icon-load-c spin"})]},proxy:!0}:{key:"button-content",fn:function(){return[a("i",{staticClass:"icon icon-dot-3"})]},proxy:!0}],null,!0)},[a("router-link",{attrs:{tag:"b-dropdown-item",to:"/products/"+e.id}},[t._v("Editar")]),a("b-dropdown-divider"),a("b-dropdown-item",{staticClass:"delete-item",on:{click:function(a){return t.deletePrompt(e)}}},[a("i",{staticClass:"icon icon-trashcan"}),t._v(" Eliminar")])],1)],1)])}))],2),0!=t.list.length||t.loading?t._e():a("div",{staticClass:"alert alert-info text-center"},[t._v(" No se han encontrado vehículos ")]),a("Pagination",{attrs:{pageData:t.pagination},on:{pageChange:t.pageChange,pageLength:t.pageLength}})],1)])])])},o=[],l=a("8785"),c=(a("ac1f"),a("841c"),a("d81d"),a("9530")),u=a.n(c),d=a("9f12"),f=a("d479"),m={name:"Products",components:{Breadcrumb:f["a"]},mixins:[d["a"]],data:function(){return{list:[],loading:!1,filters:{search:"",status:"",brand:"",minPrice:"",maxPrice:""},searchTimeout:null}},beforeMount:function(){this.filters=this.getValidUrlParams(),this.load()},methods:{load:function(){var t=this;this.loading=!0,this.$apollo.query({query:u()(i||(i=Object(l["a"])(["\n\t\t\t\t\t\tquery($take: Int, $skip: Int, $search: String, $status: String, $brand: String, $minPrice: Float, $maxPrice: Float) {\n\t\t\t\t\t\t\tproducts(take: $take, skip: $skip, search: $search, status: $status, brand: $brand, minPrice: $minPrice, maxPrice: $maxPrice) {\n\t\t\t\t\t\t\t\tdata {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\t\t\tslug\n\t\t\t\t\t\t\t\t\tprice\n\t\t\t\t\t\t\t\t\tbrand\n\t\t\t\t\t\t\t\t\tmodel\n\t\t\t\t\t\t\t\t\tyear\n\t\t\t\t\t\t\t\t\tstatus\n\t\t\t\t\t\t\t\t\tstatusText\n\t\t\t\t\t\t\t\t\tstatusClass\n\t\t\t\t\t\t\t\t\timage {\n\t\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\t\turl\n\t\t\t\t\t\t\t\t\t\turlThumb\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tpageInfo {\n\t\t\t\t\t\t\t\t\ttotalItems\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{take:this.pagination.length,skip:this.pagination.skip,search:this.filters.search||null,status:this.filters.status||null,brand:this.filters.brand||null,minPrice:this.filters.minPrice?parseFloat(this.filters.minPrice):null,maxPrice:this.filters.maxPrice?parseFloat(this.filters.maxPrice):null},fetchPolicy:"network-only"}).then((function(e){t.list=e.data.products.data,t.pagination.pageInfo=e.data.products.pageInfo,t.loading=!1}))},debounceSearch:function(){var t=this;clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){t.load()}),500)},clearFilters:function(){this.filters={search:"",status:"",brand:"",minPrice:"",maxPrice:""},this.load()},sorted:function(t){var e=this;if(t.moved){var a=Math.max.apply(Math,this.list.map((function(t){return t.order})));this.list.map((function(t){t.order=a,a-=1}));var i=this.list.map((function(t){return{id:t.id,order:t.order}}));return this.$apollo.mutate({mutation:u()(r||(r=Object(l["a"])(["\n\t\t\t\t\t\t\tmutation($list: [OrderList]!) {\n\t\t\t\t\t\t\t\tproductSort(list: $list)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t"]))),variables:{list:i}}).then((function(){e.$toast.success("Listado actualizado")})).catch((function(t){e.parseGQLErrors(t)}))}},deletePrompt:function(t){var e=this;this.$dialog.confirm({title:"Eliminar vehículo",body:'¿Está seguro que desea eliminar el vehículo "<strong>'.concat(t.title,'</strong>"?')},{okText:"Eliminar",customClass:"delete-prompt"}).then((function(){e.delete(t)}))},delete:function(t){var e=this;this.$apollo.mutate({mutation:u()(n||(n=Object(l["a"])(["\n\t\t\t\t\t\tmutation($id: ID!) {\n\t\t\t\t\t\t\tproductDelete(id: $id) {\n\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t"]))),variables:{id:t.id}}).then((function(){e.$toast.success("Vehículo eliminado correctamente"),e.load()})).catch((function(t){e.parseGQLErrors(t)}))}}},h=m,p=(a("7b7a"),a("2877")),v=Object(p["a"])(h,s,o,!1,null,"1fecf88e",null);e["default"]=v.exports}}]);