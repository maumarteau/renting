{"version":3,"sources":["webpack:///./src/mixins/mixins.js","webpack:///./src/views/users/UserForm.vue?45d7","webpack:///./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js","webpack:///./src/mixins/formMixins.js","webpack:///./src/views/users/UserForm.vue?0cbd","webpack:///src/views/users/UserForm.vue","webpack:///./src/views/users/UserForm.vue?92cc","webpack:///./src/views/users/UserForm.vue"],"names":["Vue","mixin","data","API_URL","process","methods","parseGQLErrors","error","errorMessage","graphQLErrors","message","networkError","result","errors","this","$toast","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","call","step","next","_e2","saving","covertArrayToSelectableObject","items","results","item","push","id","label","name","render","_vm","_h","$createElement","_c","_self","attrs","loading","title","scopedSlots","_u","key","fn","proxy","staticClass","ref","on","save","model","callback","$$v","form","expression","offices","_v","_l","section","sectionIndex","_s","$event","permissionAccessChanged","$set","access","permission","selected","description","$router","go","staticRenderFns","component"],"mappings":"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","file":"js/chunk-89ca9eec.93a48768.js","sourcesContent":["import Vue from 'vue'\n\n// defino variables y funciones globales\nexport default Vue.mixin({\n    data() {\n        return{\n            API_URL: process.env.VUE_APP_API_URL,\n        }\n    },\n    methods: {\n        \n        parseGQLErrors (error) {\n            let errorMessage\n            \n            if(error.graphQLErrors){\n                errorMessage = error.graphQLErrors[0] ? error.graphQLErrors[0].message : null\n            }\n            \n            if(error.networkError && !errorMessage){\n                errorMessage = error.networkError.result.errors[0] ? error.networkError.result.errors[0].message : null\n            }\n\n            if(error.message && !errorMessage){\n                errorMessage = error.message\n            }\n\n            if(!errorMessage){\n                errorMessage = 'Ha ocurrido un error'\n            }\n            this.$toast.error(errorMessage)\n            return errorMessage\n        },\n    }\n})\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserForm.vue?vue&type=style&index=0&id=dba76f48&scoped=true&lang=css&\"","import unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nexport default function _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function F() {};\n\n      return {\n        s: F,\n        n: function n() {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function e(_e) {\n          throw _e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function s() {\n      it = it.call(o);\n    },\n    n: function n() {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function e(_e2) {\n      didErr = true;\n      err = _e2;\n    },\n    f: function f() {\n      try {\n        if (!normalCompletion && it[\"return\"] != null) it[\"return\"]();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}","import Vue from 'vue'\nexport default Vue.mixin({\n    data: function () {\n        return {\n            saving: false\n        }\n    },\n    methods: {\n        // convierto array al formato de select de vueformulate select\n        // covertArrayToSelectableObject(items){\n\t\t// \tvar results = {}\n\t\t// \titems.forEach( item =>{\n\t\t// \t\tresults[`${item.id}`] = item.name\n\t\t// \t})\n\t\t// \treturn results\n        // },\n        covertArrayToSelectableObject(items){\n            var results = []\n            for (const item of items){\n                results.push({ value: item.id, label: item.name })\n\t\t\t}\n\t\t\treturn results\n        },\n        \n    }\n})\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{attrs:{\"loading\":_vm.loading,\"pageTitle\":_vm.title},scopedSlots:_vm._u([{key:\"cta\",fn:function(){return undefined},proxy:true}])},[_c('div',{staticClass:\"main-container\"},[_c('div',{staticClass:\"card mt-2\"},[_c('div',{staticClass:\"card-body\"},[_c('FormulateForm',{ref:\"form\",on:{\"submit\":_vm.save},model:{value:(_vm.form),callback:function ($$v) {_vm.form=$$v},expression:\"form\"}},[_c('FormulateInput',{attrs:{\"label\":\"Nombre\",\"name\":\"name\",\"validation-name\":\"Nombre\",\"validation\":\"required\"}}),_c('FormulateInput',{attrs:{\"label\":\"Apellido\",\"name\":\"lastname\",\"validation-name\":\"Apellido\",\"validation\":\"required\"}}),_c('FormulateInput',{attrs:{\"label\":\"Email\",\"type\":\"email\",\"name\":\"email\",\"validation-name\":\"Email\",\"validation\":\"required\"}}),_c('FormulateInput',{attrs:{\"label\":\"Teléfono\",\"type\":\"phone\",\"name\":\"phone\",\"validation-name\":\"Teléfono\",\"validation\":\"optional|^phone\"}}),(_vm.offices)?_c('FormulateInput',{attrs:{\"label\":\"Oficina\",\"validation-name\":\"Oficina\",\"name\":\"office\",\"options\":_vm.offices,\"type\":\"selectSearch\",\"option-value\":\"id\",\"option-text\":\"name\",\"placeholder\":\"Seleccione una oficina\",\"validation\":\"required\"}}):_vm._e(),_c('div',{staticClass:\"label\"},[_vm._v(\"Permisos\")]),_vm._l((_vm.permissionsSections),function(section,sectionIndex){return _c('div',{key:section.id,staticClass:\"w-100 border-bottom p-3\"},[_c('div',{staticClass:\"d-flex justify-content-between\"},[_c('h5',[_c('small',[_vm._v(_vm._s(section.name))])]),_c('div',[_c('b-form-radio-group',{on:{\"change\":function($event){return _vm.permissionAccessChanged(sectionIndex)}},model:{value:(section.access),callback:function ($$v) {_vm.$set(section, \"access\", $$v)},expression:\"section.access\"}},[_c('b-form-radio',{attrs:{\"value\":\"FULL\"}},[_vm._v(\"Full\")]),_c('b-form-radio',{attrs:{\"value\":\"SOME\"}},[_vm._v(\"Parcial\")]),_c('b-form-radio',{attrs:{\"value\":\"NONE\"}},[_vm._v(\"Ninguno\")])],1)],1)]),_c('b-collapse',{staticClass:\"mt-2\",attrs:{\"visible\":section.access=='SOME'}},[_c('div',{staticClass:\"list-group\"},_vm._l((section.permissions),function(permission){return _c('div',{key:permission.id,staticClass:\"item\"},[_c('FormulateInput',{staticClass:\"mr-2\",attrs:{\"type\":\"checkbox\"},model:{value:(permission.selected),callback:function ($$v) {_vm.$set(permission, \"selected\", $$v)},expression:\"permission.selected\"}}),_c('div',{staticClass:\"flex-grow-1\",on:{\"click\":function($event){permission.selected = !permission.selected}}},[_c('h6',[_vm._v(_vm._s(permission.name))]),(permission.description)?_c('p',{staticClass:\"text-secondary\"},[_vm._v(_vm._s(permission.description))]):_vm._e()])],1)}),0)])],1)}),_c('div',{staticClass:\"d-flex justify-content-between mt-4\"},[_c('FormulateInput',{attrs:{\"type\":\"button\",\"data-ghost\":\"\"},on:{\"click\":function($event){return _vm.$router.go(-1)}}},[_vm._v(\"Cancelar\")]),(_vm.saving)?_c('FormulateInput',{attrs:{\"type\":\"button\",\"disabled\":\"\"}},[_vm._v(\"Guardando \"),_c('span',{staticClass:\"loader\"})]):_c('FormulateInput',{attrs:{\"type\":\"submit\",\"label\":_vm.title}})],1)],2)],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n\n<Layout :loading=\"loading\" :pageTitle=\"title\">\n\n\t<template #cta>\n\t\t<!-- <div @click=\"save\" class=\"btn btn-success\">Crear</div> -->\n\t</template>\n\n\t<div class=\"main-container\">\n\t\t<div class=\"card mt-2\">\n\t\t\t<div class=\"card-body\">\n\t\t\t\t\t\t\t\n\t\t\t\t<FormulateForm\n\t\t\t\t\tref=\"form\"\n\t\t\t\t\tv-model=\"form\"\n\t\t\t\t\t@submit=\"save\" \n\t\t\t\t\t>\n\t\t\t\t\t\n\t\t\t\t\t<FormulateInput\n\t\t\t\t\t\tlabel=\"Nombre\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\tvalidation-name=\"Nombre\"\n\t\t\t\t\t\tvalidation=\"required\"\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t<FormulateInput\n\t\t\t\t\t\tlabel=\"Apellido\"\n\t\t\t\t\t\tname=\"lastname\"\n\t\t\t\t\t\tvalidation-name=\"Apellido\"\n\t\t\t\t\t\tvalidation=\"required\"\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t<FormulateInput\n\t\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\tvalidation-name=\"Email\"\n\t\t\t\t\t\tvalidation=\"required\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<FormulateInput\n\t\t\t\t\t\tlabel=\"Teléfono\"\n\t\t\t\t\t\ttype=\"phone\"\n\t\t\t\t\t\tname=\"phone\"\n\t\t\t\t\t\tvalidation-name=\"Teléfono\"\n\t\t\t\t\t\tvalidation=\"optional|^phone\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<FormulateInput\n\t\t\t\t\t\tv-if=\"offices\"\n\t\t\t\t\t\tlabel=\"Oficina\"\n\t\t\t\t\t\tvalidation-name=\"Oficina\"\n\t\t\t\t\t\tname=\"office\"\n\t\t\t\t\t\t:options=\"offices\"\n\t\t\t\t\t\ttype=\"selectSearch\"\n\t\t\t\t\t\toption-value=\"id\"\n\t\t\t\t\t\toption-text=\"name\"\n\t\t\t\t\t\tplaceholder=\"Seleccione una oficina\"\n\t\t\t\t\t\tvalidation=\"required\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"label\">Permisos</div>\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"w-100 border-bottom p-3\" v-for=\"(section, sectionIndex)  in permissionsSections\" :key=\"section.id\">\n\t\t\t\t\t\t<div class=\"d-flex justify-content-between\">\n\t\t\t\t\t\t\t<h5><small>{{section.name}}</small></h5>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<b-form-radio-group v-model=\"section.access\" @change=\"permissionAccessChanged(sectionIndex)\">\n\t\t\t\t\t\t\t\t\t<b-form-radio value=\"FULL\">Full</b-form-radio>\n\t\t\t\t\t\t\t\t\t<b-form-radio value=\"SOME\">Parcial</b-form-radio>\n\t\t\t\t\t\t\t\t\t<b-form-radio value=\"NONE\">Ninguno</b-form-radio>\n\t\t\t\t\t\t\t\t</b-form-radio-group>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<b-collapse  class=\"mt-2\" :visible=\"section.access=='SOME'\">\n\t\t\t\t\t\t\t<div class=\"list-group\">\n\t\t\t\t\t\t\t\t<div class=\"item\" v-for=\"permission in section.permissions\" :key=\"permission.id\" >\n\t\t\t\t\t\t\t\t\t<FormulateInput v-model=\"permission.selected\" type=\"checkbox\" class=\"mr-2\" />\n\t\t\t\t\t\t\t\t\t<div class=\"flex-grow-1\" @click=\"permission.selected = !permission.selected\" >\n\t\t\t\t\t\t\t\t\t\t<h6>{{permission.name}}</h6>\n\t\t\t\t\t\t\t\t\t\t<p class=\"text-secondary\" v-if=\"permission.description\">{{permission.description}}</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</b-collapse>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t\n\t\t\t\t\t<div class=\"d-flex justify-content-between mt-4\">\n\t\t\t\t\t\t<FormulateInput type=\"button\" data-ghost @click=\"$router.go(-1)\" >Cancelar</FormulateInput>\n\t\t\t\t\t\t<FormulateInput type=\"button\" disabled v-if=\"saving\">Guardando <span class=\"loader\" /></FormulateInput>\n\t\t\t\t\t\t<FormulateInput type=\"submit\" :label=\"title\" v-else />\n\t\t\t\t\t</div>\n\n\t\t\t\t</FormulateForm>\n\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</Layout>\n\n</template>\n\n<script>\nimport gql from 'graphql-tag'\n\nimport mixins from '@/mixins/mixins'\nimport formMixins from '@/mixins/formMixins'\n\nexport default {\n\tname: 'UserForm',\n\tmixins: [mixins, formMixins],\n\tdata () {\n\t\treturn {\n\t\t\ttitle: 'Crear usuario',\n\t\t\taction: 'create',\n\t\t\tloading: false,\n\t\t\tform:{\n\t\t\t\tname: null,\n\t\t\t\tlastname: null,\n\t\t\t\temail: null,\n\t\t\t\tphone: null,\n\t\t\t\tpassword: null,\n\t\t\t\tpasswordConfirm: null,\n\t\t\t},\n\t\t\toffices:[],\n\t\t\tpermissionsSections: [],\n\t\t\t\n\n\t\t}\n\t},\n\tasync beforeMount(){\n\t\tthis.loading = true\n\t\tthis.offices = await this.fetchData()\n\t\tif(this.$route.params.id){\n\t\t\tthis.action = 'update'\n\t\t\tthis.title = `Editar usuario`\n\t\t\tawait this.load()\n\t\t}\n\t\tthis.loading = false\n\t},\n\tmethods:{\n\t\tsave(){\n\t\t\tif(!this.saving){\n\t\t\t\tthis.saving = true\n\t\t\t\tlet permissions = {}\n\t\t\t\tthis.permissionsSections.forEach( g => { g.permissions.map( p => permissions[p.permission] = p.selected ) })\n\t\t\t\tlet dataInput = {\n\t\t\t\t\tname: this.form.name,\n\t\t\t\t\tlastname: this.form.lastname,\n\t\t\t\t\temail: this.form.email,\n\t\t\t\t\tphone: this.form.phone,\n\t\t\t\t\toffice: (this.form.office) ? this.form.office.id : null,\n\t\t\t\t\tpassword: this.form.password,\n\t\t\t\t\tpermissions\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(this.action =='create'){\n\t\t\t\t\tthis.create(dataInput)\n\t\t\t\t}\n\t\t\t\tif(this.action =='update'){\n\t\t\t\t\tthis.update(dataInput)\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tcreate(data){\n\t\t\tthis.$apollo.mutate({\n\t\t\t\tmutation: gql`mutation ( $data:UserInput! ){\n\t\t\t\t\tuserCreate( data: $data) {\n\t\t\t\t\t\tid\n\t\t\t\t\t}\n\t\t\t\t}`,\n\t\t\t\tvariables: {\n\t\t\t\t\tdata\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.$toast.success('Usuario creado correctamente')\n\t\t\t\tthis.$router.go(-1)\n\t\t\t\tthis.saving = false\n\t\t\t})\n\t\t\t.catch( (error) => {\n\t\t\t\tthis.parseGQLErrors(error)\n\t\t\t\tthis.saving = false\n\t\t\t})\n\t\t},\n\n\t\tupdate(dataInput){\n\t\t\tthis.$apollo.mutate({\n\t\t\t\tmutation: gql`mutation ( $id: ID!, $data:UserInput! ){\n\t\t\t\t\tuserUpdate( id: $id, data: $data) {\n\t\t\t\t\t\tid\n\t\t\t\t\t}\n\t\t\t\t}`,\n\t\t\t\tvariables: {\n\t\t\t\t\tid: this.$route.params.id,\n\t\t\t\t\tdata: dataInput\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(() => {\n\t\t\t\tthis.$toast.success('Usuario editado correctamente')\n\t\t\t\tthis.$router.go(-1)\n\t\t\t\tthis.saving = false\n\t\t\t})\n\t\t\t.catch( (error) => {\n\t\t\t\tthis.errors = this.parseGQLErrors(error)\n\t\t\t\tthis.saving = false\n\t\t\t})\n\t\t},\n\n\t\tfetchData(){\n\t\t\treturn this.$apollo.query({\n\t\t\t\tquery: gql`query {\n\t\t\t\t\toffices {\n\t\t\t\t\t\tdata{\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}`,\n\t\t\t\tfetchPolicy: 'network-only',\n\t\t\t})\n\t\t\t.then(({data}) => {\n\t\t\t\treturn data.offices.data\n\t\t\t})\n\t\t\t.catch((err)=>{\n\t\t\t\tconsole.log(err)\n\t\t\t})\n\n\t\t},\n\n\t\tload(){\n\t\t\tthis.loading = true\n\t\t\treturn this.$apollo.query({\n\t\t\t\tquery: gql`query ($id: ID!) {\n\t\t\t\t\tuser(id: $id) {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tname\n\t\t\t\t\t\tlastname\n\t\t\t\t\t\temail\n\t\t\t\t\t\tphone{\n\t\t\t\t\t\t\tcountryCode\n\t\t\t\t\t\t\tnational\n\t\t\t\t\t\t\tinternational\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tvalidated\n\t\t\t\t\t\t}\n\t\t\t\t\t\toffice{ id }\n\t\t\t\t\t\tpermissions\n\t\t\t\t\t}\n\t\t\t\t\tpermissionSections{\n\t\t\t\t\t\tid\n\t\t\t\t\t\tname\n\t\t\t\t\t\tpermissions{\n\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\tpermission\n\t\t\t\t\t\t\tdescription\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}`,\n\t\t\t\tvariables: { id: this.$route.params.id },\n\t\t\t\tfetchPolicy: 'network-only',\n\t\t\t})\n\t\t\t.then(({data}) => {\t\t\t\t\n\t\t\t\tthis.form = {\n\t\t\t\t\t...this.$omitDeep(data.user, \"__typename\"),\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tthis.parsePermissions(data.permissionSections, data.user.permissions)\n\t\t\t\t\n\t\t\t\tthis.loading = false\n\t\t\t})\n\t\t\t.catch((err)=>{\n\t\t\t\tthis.$toast.success('El item que desea editar no existe')\n\t\t\t\t// this.$router.go(-1)\n\t\t\t})\n\n\t\t},\n\n\t\tparsePermissions(groups, userPermissions){\n\t\t\tgroups = groups.map(group=>{\n\t\t\t\tconst permissions = group.permissions.map( (p) => { \n\t\t\t\t\tconsole.log(p.permission)\n\t\t\t\t\tp.selected= userPermissions[p.permission]\n\t\t\t\t})\n\t\t\t\tconst selecteds = group.permissions.filter(perm => perm.selected==true )\n\t\t\t\tlet access = 'NONE'\n\t\t\t\tif( permissions.length ){\n\t\t\t\t\taccess = (selecteds.length == permissions.length ) ? 'FULL' : (selecteds.length>0) ? 'SOME' : 'NONE'\n\t\t\t\t}\n\t\t\t\treturn { ...group, ...permissions, access}\n\t\t\t})\n\t\t\tthis.permissionsSections = groups\n\t\t},\n\n\n\t\tpermissionAccessChanged(sectionIndex){\n\t\t\tif(this.permissionsSections[sectionIndex].access == 'NONE'){\n\t\t\t\tthis.permissionsSections[sectionIndex].permissions.map(p=> p.selected = false )\n\t\t\t}\n\t\t\tif(this.permissionsSections[sectionIndex].access == 'FULL'){\n\t\t\t\tthis.permissionsSections[sectionIndex].permissions.map(p=> p.selected = true )\n\t\t\t}\n\t\t},\n\n\t\n\t}\n}\n\n\n</script>\n\n<style scoped>\n\n.list-group .item .formulate-input{\n\tmargin: 4px 8px 4px 8px;\n}\n\n.list-group .item{\n\talign-items: center;\n\tpadding: .5rem 0.5rem !important;\n}\n.list-group .item:last-child{\n\tborder:none;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserForm.vue?vue&type=template&id=dba76f48&scoped=true&\"\nimport script from \"./UserForm.vue?vue&type=script&lang=js&\"\nexport * from \"./UserForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserForm.vue?vue&type=style&index=0&id=dba76f48&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"dba76f48\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}